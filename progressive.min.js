(function(e){function f(t){var n=Math.max(e.MAX_BUFFER_LENGTH,10),r=0;for(var s=0,o=i.length;s<o;s++){var u=t[i[s]].length;if(u>n)switch(i[s]){case"text":closeText(t);break;default:E(t,"Max buffer length exceeded: "+i[s])}r=Math.max(r,u)}t.bufferCheckPosition=e.MAX_BUFFER_LENGTH-r+t.position}function l(e){for(var t=0,n=i.length;t<n;t++)e[i[t]]=""}function h(t){if(!(this instanceof h))return new h(t);var r=this;l(r),r.bufferCheckPosition=e.MAX_BUFFER_LENGTH,r.q=r.c=r.p="",r.opt=t||{},r.closed=r.closedRoot=r.sawRoot=!1,r.tag=r.error=null,r.state=o.BEGIN,r.stack=new n,r.position=r.column=0,r.line=1,r.slashed=!1,r.unicodeI=0,r.unicodeS=null,m(r,"onready")}function d(e){return new v(e)}function v(e){if(!(this instanceof v))return new v(e);this._parser=new h(e),this.writable=!0,this.readable=!0;var t=this;u.apply(t),this._parser.onend=function(){t.emit("end")},this._parser.onerror=function(e){t.emit("error",e),t._parser.error=null},s.forEach(function(e){Object.defineProperty(t,"on"+e,{get:function(){return t._parser["on"+e]},set:function(n){if(!n)return t.removeAllListeners(e),t._parser["on"+e]=n,n;t.on(e,n)},enumerable:!0,configurable:!1})})}function m(t,n,r){e.INFO&&console.log("-- emit",n,r),t[n]&&t[n](r)}function g(e,t,n){y(e),m(e,t,n)}function y(e,t){e.textNode=w(e.opt,e.textNode),e.textNode&&m(e,t?t:"onvalue",e.textNode),e.textNode=""}function b(e){e.numberNode&&m(e,"onvalue",parseFloat(e.numberNode)),e.numberNode=""}function w(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function E(e,t){return y(e),t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c,t=new Error(t),e.error=t,m(e,"onerror",t),e}function S(e){return e.state!==o.VALUE&&E(e,"Unexpected end"),y(e),e.c="",e.closed=!0,m(e,"onend"),h.call(e,e.opt),e}function x(t){var n=this;if(this.error)throw this.error;if(n.closed)return E(n,"Cannot write after close. Assign an onready handler.");if(t===null)return S(n);var r=0,i=t[0],s=n.p;e.DEBUG&&console.log("write -> ["+t+"]");while(i){s=i,n.c=i=t.charAt(r++),s!==i?n.p=s:s=n.p;if(!i)break;e.DEBUG&&console.log(r,i,e.STATE[n.state]),n.position++,i==="\n"?(n.line++,n.column=0):n.column++;switch(n.state){case o.BEGIN:i==="{"?n.state=o.OPEN_OBJECT:i==="["?n.state=o.OPEN_ARRAY:i!=="\r"&&i!=="\n"&&i!==" "&&i!=="	"&&E(n,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(i==="\r"||i==="\n"||i===" "||i==="	")continue;if(n.state===o.OPEN_KEY)n.stack.push(o.CLOSE_KEY);else{if(i==="}"){m(n,"onopenobject"),m(n,"oncloseobject"),n.state=n.stack.pop()||o.VALUE;continue}n.stack.push(o.CLOSE_OBJECT)}i==='"'?n.state=o.STRING:E(n,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(i==="\r"||i==="\n"||i===" "||i==="	")continue;var u=n.state===o.CLOSE_KEY?"key":"object";i===":"?(n.state===o.CLOSE_OBJECT?(n.stack.push(o.CLOSE_OBJECT),y(n,"onopenobject")):y(n,"onkey"),n.state=o.VALUE):i==="}"?(g(n,"oncloseobject"),n.state=n.stack.pop()||o.VALUE):i===","?(n.state===o.CLOSE_OBJECT&&n.stack.push(o.CLOSE_OBJECT),y(n),n.state=o.OPEN_KEY):E(n,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(i==="\r"||i==="\n"||i===" "||i==="	")continue;if(n.state===o.OPEN_ARRAY){m(n,"onopenarray"),n.state=o.VALUE;if(i==="]"){m(n,"onclosearray"),n.state=n.stack.pop()||o.VALUE;continue}n.stack.push(o.CLOSE_ARRAY)}i==='"'?n.state=o.STRING:i==="{"?n.state=o.OPEN_OBJECT:i==="["?n.state=o.OPEN_ARRAY:i==="t"?n.state=o.TRUE:i==="f"?n.state=o.FALSE:i==="n"?n.state=o.NULL:i==="-"?n.numberNode+=i:i==="0"?(n.numberNode+=i,n.state=o.NUMBER_DIGIT):"123456789".indexOf(i)!==-1?(n.numberNode+=i,n.state=o.NUMBER_DIGIT):E(n,"Bad value");continue;case o.CLOSE_ARRAY:if(i===",")n.stack.push(o.CLOSE_ARRAY),y(n,"onvalue"),n.state=o.VALUE;else if(i==="]")g(n,"onclosearray"),n.state=n.stack.pop()||o.VALUE;else{if(i==="\r"||i==="\n"||i===" "||i==="	")continue;E(n,"Bad array")}continue;case o.STRING:var a=r-1,l=n.slashed,h=n.unicodeI;e:for(;;){e.DEBUG&&console.log(r,i,e.STATE[n.state],l);while(h>0){n.unicodeS+=i,i=t.charAt(r++),h===4?(n.textNode+=String.fromCharCode(parseInt(n.unicodeS,16)),h=0,a=r-1):h++;if(!i)break e}if(i==='"'&&!l){n.state=n.stack.pop()||o.VALUE,n.textNode+=t.substring(a,r-1),n.textNode||m(n,"onvalue","");break}if(i==="\\"&&!l){l=!0,n.textNode+=t.substring(a,r-1),i=t.charAt(r++);if(!i)break}if(l){l=!1,i==="n"?n.textNode+="\n":i==="r"?n.textNode+="\r":i==="t"?n.textNode+="	":i==="f"?n.textNode+="\f":i==="b"?n.textNode+="\b":i==="u"?(h=1,n.unicodeS=""):n.textNode+=i,i=t.charAt(r++),a=r-1;if(!i)break;continue}c.lastIndex=r;var p=c.exec(t);if(p===null){r=t.length+1,n.textNode+=t.substring(a,r-1);break}r=p.index+1,i=t.charAt(p.index);if(!i){n.textNode+=t.substring(a,r-1);break}}n.slashed=l,n.unicodeI=h;continue;case o.TRUE:if(i==="")continue;i==="r"?n.state=o.TRUE2:E(n,"Invalid true started with t"+i);continue;case o.TRUE2:if(i==="")continue;i==="u"?n.state=o.TRUE3:E(n,"Invalid true started with tr"+i);continue;case o.TRUE3:if(i==="")continue;i==="e"?(m(n,"onvalue",!0),n.state=n.stack.pop()||o.VALUE):E(n,"Invalid true started with tru"+i);continue;case o.FALSE:if(i==="")continue;i==="a"?n.state=o.FALSE2:E(n,"Invalid false started with f"+i);continue;case o.FALSE2:if(i==="")continue;i==="l"?n.state=o.FALSE3:E(n,"Invalid false started with fa"+i);continue;case o.FALSE3:if(i==="")continue;i==="s"?n.state=o.FALSE4:E(n,"Invalid false started with fal"+i);continue;case o.FALSE4:if(i==="")continue;i==="e"?(m(n,"onvalue",!1),n.state=n.stack.pop()||o.VALUE):E(n,"Invalid false started with fals"+i);continue;case o.NULL:if(i==="")continue;i==="u"?n.state=o.NULL2:E(n,"Invalid null started with n"+i);continue;case o.NULL2:if(i==="")continue;i==="l"?n.state=o.NULL3:E(n,"Invalid null started with nu"+i);continue;case o.NULL3:if(i==="")continue;i==="l"?(m(n,"onvalue",null),n.state=n.stack.pop()||o.VALUE):E(n,"Invalid null started with nul"+i);continue;case o.NUMBER_DECIMAL_POINT:i==="."?(n.numberNode+=i,n.state=o.NUMBER_DIGIT):E(n,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:"0123456789".indexOf(i)!==-1?n.numberNode+=i:i==="."?(n.numberNode.indexOf(".")!==-1&&E(n,"Invalid number has two dots"),n.numberNode+=i):i==="e"||i==="E"?((n.numberNode.indexOf("e")!==-1||n.numberNode.indexOf("E")!==-1)&&E(n,"Invalid number has two exponential"),n.numberNode+=i):i==="+"||i==="-"?(s!=="e"&&s!=="E"&&E(n,"Invalid symbol in number"),n.numberNode+=i):(b(n),r--,n.state=n.stack.pop()||o.VALUE);continue;default:E(n,"Unknown state: "+n.state)}}return n.position>=n.bufferCheckPosition&&f(n),n}var t,n;typeof process=="object"&&process.env?t=process.env:t=window;if(typeof FastList=="function")n=FastList;else if(typeof require=="function")try{n=require("fast-list")}catch(r){n=Array}else n=Array;e.parser=function(e){return new h(e)},e.CParser=h,e.CStream=v,e.createStream=d,e.MAX_BUFFER_LENGTH=65536,e.DEBUG=t.CDEBUG==="debug",e.INFO=t.CDEBUG==="debug"||t.CDEBUG==="info",e.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var i=["textNode","numberNode"],s=e.EVENTS.filter(function(e){return e!=="error"&&e!=="end"}),o=0,u;e.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++};for(var a in e.STATE)e.STATE[e.STATE[a]]=a;o=e.STATE,Object.create||(Object.create=function(e){function t(){this.__proto__=e}return t.prototype=e,new t}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t});var c=/[\\"\n]/g;h.prototype={end:function(){S(this)},write:x,resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{u=require("stream").Stream}catch(p){u=function(){}}v.prototype=Object.create(u.prototype,{constructor:{value:v}}),v.prototype.write=function(e){return this._parser.write(e.toString()),this.emit("data",e),!0},v.prototype.end=function(e){return e&&e.length&&this._parser.write(e.toString()),this._parser.end(),!0},v.prototype.on=function(e,t){var n=this;return!n._parser["on"+e]&&s.indexOf(e)!==-1&&(n._parser["on"+e]=function(){var t=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),u.prototype.on.call(n,e,t)},v.prototype.destroy=function(){l(this._parser),this.emit("close")}})(typeof exports=="undefined"?clarinet={}:exports),define("libs/clarinet",function(){}),function(e){e.fetch=function(e,t){function i(){if(n.responseText.length>r){var e=n.responseText.substr(r);r=n.responseText.length,t(e)}}var n=new XMLHttpRequest,r=0;n.open("GET",e,!0),n.send(null),n.onprogress=n.onload=i}}(typeof exports=="undefined"?streamingXhr={}:exports),define("streamingXhr",function(){}),require(["libs/clarinet","streamingXhr"],function(e,t){(function(e){function r(e){return e[e.length-1]}function i(e){return e&&e.constructor===Array}function s(e){var t=n.parser(e);this._thingFoundListeners=[],this._pathMatchedListeners=[],this._clarinet=t;var s=this,o,a,f,l=[],c=[];t.onkey=function(e){u(s._pathMatchedListeners,null,c.concat(e)),f=e},t.onvalue=function(e){u(s._thingFoundListeners,e,c.concat(f)),i(a)?(a.push(e),f++):(a[f]=e,f=null)},t.onopenobject=function(e){var t={};u(s._pathMatchedListeners,t,c),u(s._pathMatchedListeners,null,c.concat(e)),a&&(a[f]=t),a=t,l.push(t),o?c.push(f):o=a,f=e},t.onopenarray=function(){var e=[];a[f]=e,a=e,l.push(e),c.push(f),u(s._pathMatchedListeners,e,c),f=0},t.onend=t.oncloseobject=t.onclosearray=function(){u(s._thingFoundListeners,a,c),l.pop(),c.pop(),a=r(l),i(a)&&(f=a.length)},t.onerror=function(e){s.onerror&&s.onerror(e)}}function o(e){var t="//"+e.join("/");return function(e){return e.regex.test(t)}}function u(e,t,n){var r=e.filter(o(n));r.forEach(function(e){e.callback(t,n)})}function a(e){var t=e.replace(/\w+/g,"$&(\\b|$)").replace(/\*\*/g,"__any__").replace(/\*/g,"(//|[^\\/]+?)").replace(/\/\//,"^\\/\\/").replace(/__any__/g,".*?");return t+="$",new RegExp(t)}function f(e,t,n){return e.push({pattern:t,regex:a(t),callback:n})}var n=window.clarinet||require("clarinet");e.parser=function(e){return new s(e)},e.fetch=function(e){return(new s).fetch(e)},s.prototype.fetch=function(e){return t.fetch(e,this.read.bind(this)),this},s.prototype.read=function(e){this._clarinet.write(e)},s.prototype.onPath=function(e,t){return f(this._pathMatchedListeners,e,t),this},s.prototype.onFind=function(e,t){return f(this._thingFoundListeners,e,t),this}})(typeof exports=="undefined"?progressive={}:exports)}),define("progressive",function(){});